{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nexport default {\n  data() {\n    return {\n      value: '',\n      city: '',\n      searchList: []\n    };\n  },\n  watch: {\n    value() {\n      const _this = this;\n      // JSAPI 2.0 输入提示插件名称由 AMap.Autocomplete 变更为 AMap.AutoComplete 啦！\n      AMap.plugin('AMap.AutoComplete', function () {\n        var autoOptions = {\n          //city 限定城市，默认全国\n          city: _this.city\n        };\n        // 实例化AutoComplete\n        var autoComplete = new AMap.AutoComplete(autoOptions);\n        // 根据关键字进行搜索\n        autoComplete.search(_this.value, function (status, result) {\n          // 搜索成功时，result即是对应的匹配数据\n          _this.searchList = result.tips;\n        });\n      });\n    }\n  },\n  methods: {\n    // 点击返回\n    onClickLeft() {\n      this.$router.push({\n        name: 'home'\n      });\n    },\n    // 点击地址返回首页并将首页的地址更改\n    goHome(item) {\n      this.$router.push({\n        name: 'home'\n      });\n      this.$store.commit('saveCityInfo', item);\n    }\n  },\n  mounted() {\n    const info = this.$store.state.cityInfo;\n    const _this = this;\n    if (info.name) {\n      var map = new AMap.Map('container', {\n        zoom: 16\n      });\n      var marker = new AMap.Marker({\n        position: [info.location.lat, info.location.lng] //位置\n      });\n\n      map.add(marker); //添加到地图\n    } else {\n      var map = new AMap.Map('container', {});\n      AMap.plugin('AMap.CitySearch', function () {\n        var citySearch = new AMap.CitySearch();\n        citySearch.getLocalCity(function (status, result) {\n          if (status === 'complete' && result.info === 'OK') {\n            // 查询成功，result即为当前所在城市信息\n            _this.city = result.city;\n          }\n        });\n      });\n    }\n  }\n};","map":{"version":3,"mappings":";AAiBA;EACAA;IACA;MACAC;MACAC;MACAC;IACA;EACA;EACAC;IACAH;MACA;MACA;MACAI;QACA;UACA;UACAH;QACA;QACA;QACA;QACA;QACAI;UACA;UACAC;QACA;MACA;IACA;EACA;EACAC;IACA;IACAC;MACA;QAAAC;MAAA;IACA;IACA;IACAC;MACA;QAAAD;MAAA;MACA;IACA;EACA;EACAE;IACA;IACA;IACA;MACA;QACAC;MACA;MACA;QACAC;MACA;;MACAC;IACA;MACA;MACAV;QACA;QACAW;UACA;YACA;YACAT;UACA;QACA;MACA;IACA;EACA;AACA","names":["data","value","city","searchList","watch","AMap","autoComplete","_this","methods","onClickLeft","name","goHome","mounted","zoom","position","map","citySearch"],"sourceRoot":"src/views/map","sources":["index.vue"],"sourcesContent":["<template>\r\n  <div class=\"box\">\r\n    <!-- 导航栏 -->\r\n    <van-sticky>\r\n      <van-nav-bar title=\"乐购\" left-text=\"返回\" left-arrow @click-left=\"onClickLeft\" />\r\n    </van-sticky>\r\n    <van-search v-model=\"value\" placeholder=\"请输入搜索关键词\" class=\"text\" />\r\n    <!-- 搜索结果 -->\r\n    <ul class=\"result\" v-if=\"this.value !== ''\">\r\n      <li v-for=\"item in searchList\" :key=\"item.id\" class=\"resultItem\" @click=\"goHome(item)\">{{ item.name }}</li>\r\n    </ul>\r\n    <h2>显示当前位置：</h2>\r\n    <div id=\"container\"></div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      value: '',\r\n      city: '',\r\n      searchList: []\r\n    }\r\n  },\r\n  watch: {\r\n    value() {\r\n      const _this = this\r\n      // JSAPI 2.0 输入提示插件名称由 AMap.Autocomplete 变更为 AMap.AutoComplete 啦！\r\n      AMap.plugin('AMap.AutoComplete', function () {\r\n        var autoOptions = {\r\n          //city 限定城市，默认全国\r\n          city: _this.city\r\n        }\r\n        // 实例化AutoComplete\r\n        var autoComplete = new AMap.AutoComplete(autoOptions)\r\n        // 根据关键字进行搜索\r\n        autoComplete.search(_this.value, function (status, result) {\r\n          // 搜索成功时，result即是对应的匹配数据\r\n          _this.searchList = result.tips\r\n        })\r\n      })\r\n    }\r\n  },\r\n  methods: {\r\n    // 点击返回\r\n    onClickLeft() {\r\n      this.$router.push({ name: 'home' })\r\n    },\r\n    // 点击地址返回首页并将首页的地址更改\r\n    goHome(item) {\r\n      this.$router.push({ name: 'home' })\r\n      this.$store.commit('saveCityInfo', item)\r\n    }\r\n  },\r\n  mounted() {\r\n    const info = this.$store.state.cityInfo\r\n    const _this = this\r\n    if (info.name) {\r\n      var map = new AMap.Map('container', {\r\n        zoom: 16\r\n      })\r\n      var marker = new AMap.Marker({\r\n        position: [info.location.lat, info.location.lng] //位置\r\n      })\r\n      map.add(marker) //添加到地图\r\n    } else {\r\n      var map = new AMap.Map('container', {})\r\n      AMap.plugin('AMap.CitySearch', function () {\r\n        var citySearch = new AMap.CitySearch()\r\n        citySearch.getLocalCity(function (status, result) {\r\n          if (status === 'complete' && result.info === 'OK') {\r\n            // 查询成功，result即为当前所在城市信息\r\n            _this.city = result.city\r\n          }\r\n        })\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.box {\r\n  h2 {\r\n    position: fixed;\r\n    bottom: 200px;\r\n    padding: 0 0 15px 15px;\r\n  }\r\n  #container {\r\n    width: 100%;\r\n    height: 200px;\r\n    position: fixed;\r\n    bottom: 0;\r\n  }\r\n  .text {\r\n    width: 100%;\r\n    height: 50px;\r\n    margin: 0 auto;\r\n  }\r\n  .result {\r\n    overflow: auto;\r\n    height: 320px;\r\n    .resultItem {\r\n      padding: 10px 15px;\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}