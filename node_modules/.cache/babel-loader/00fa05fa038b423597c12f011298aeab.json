{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { getInfo, deleteHistory, addHistory, promptSearch } from '@/api/home/search/index.js';\nexport default {\n  data() {\n    return {\n      value: '',\n      // 输入框的关键词\n      hotKeywordList: [],\n      // 热门搜索关键词\n      historyData: [],\n      // 历史搜索记录\n      defaultKeyword: {},\n      // 默认的搜索框提示\n      openId: '',\n      // 登录id\n      show: 1,\n      // 搜索的页面是都展开\n      order: '',\n      // 排序参数  asc desc\n      keywords: [],\n      // 搜索的联系词\n      isActive: '',\n      // 三级分类高亮颜色\n      newValue: ''\n    };\n  },\n  methods: {\n    // 点击搜索 添加关键词\n    onSearch(keyword) {\n      // keyword openId\n      addHistory({\n        openId: this.openId,\n        keyword: this.value || keyword\n      }).then(res => {\n        this.getSearchInfo();\n        this.value = '';\n      });\n      if (this.value === '') {\n        this.show = 1;\n      }\n    },\n    // 获取数据\n    getSearchInfo() {\n      this.openId = localStorage.getItem('openId');\n      getInfo({\n        openId: this.openId\n      }).then(res => {\n        this.hotKeywordList = res.hotKeywordList;\n        this.historyData = res.historyData;\n        this.defaultKeyword = res.defaultKeyword;\n      });\n    },\n    //  点击取消\n    onCancel() {\n      this.$router.push('/home');\n    },\n    // 点击返回\n    onClickLeft() {\n      this.$router.go(-1);\n    },\n    // 点击删除历史记录\n    deteleSearch() {\n      deleteHistory({\n        openId: this.openId\n      }).then(res => {\n        this.getSearchInfo();\n      });\n    },\n    // 搜索框发生变化\n    getPromptInfo() {\n      this.show = 2;\n      this.getPrompt();\n      if (this.value === '') {\n        this.show = 1;\n      }\n    },\n    // 获取搜索提示\n    getPrompt() {\n      //  keyword order\n      promptSearch({\n        keyword: this.value,\n        order: this.order\n      }).then(res => {\n        this.keywords = res.keywords;\n      });\n    },\n    // 关键词更新后的搜索\n    getNewInfo() {\n      promptSearch({\n        keyword: this.newValue,\n        order: this.order\n      }).then(res => {\n        this.keywords = res.keywords;\n      });\n    },\n    // 点击搜索产品跳转至对应产品\n    goGoods(keyword) {\n      this.show = 3;\n      this.isActive = 1;\n      this.newValue = keyword;\n      this.getNewInfo();\n    },\n    // 点击添加颜色\n    changeItem(i) {\n      this.isActive = i;\n      // 点击综合\n      if (this.isActive === 1) {\n        this.order = '';\n        this.getNewInfo();\n      }\n      // 点击价格\n      if (this.isActive === 2 && this.arrow === '') {\n        this.arrow = 'up';\n        this.order = 'asc';\n      } else if (this.isActive === 2 && this.arrow === 'up') {\n        this.arrow = 'down';\n        this.order = 'desc';\n      } else {\n        this.arrow = 'up';\n        this.order = 'asc';\n      }\n      this.getNewInfo();\n      // 点击分类 没有变化\n      if (this.isActive === 3) {\n        this.getNewInfo();\n      }\n    }\n  },\n  created() {\n    this.show = 1;\n    this.getSearchInfo();\n  }\n};","map":{"version":3,"mappings":";AA2DA;AACA;EACAA;IACA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;IACA;EACA;EACAC;IACA;IACAC;MACA;MACAC;QAAAR;QAAAS;MAAA;QACA;QACA;MACA;MACA;QACA;MACA;IACA;IACA;IACAC;MACA;MACAC;QAAAX;MAAA;QACA;QACA;QACA;MACA;IACA;IACA;IACAY;MACA;IACA;IACA;IACAC;MACA;IACA;IACA;IACAC;MACAC;QAAAf;MAAA;QACA;MACA;IACA;IACA;IACAgB;MACA;MACA;MACA;QACA;MACA;IACA;IACA;IACAC;MACA;MACAC;QAAAT;QAAAP;MAAA;QACA;MACA;IACA;IACA;IACAiB;MACAD;QAAAT;QAAAP;MAAA;QACA;MACA;IACA;IACA;IACAkB;MACA;MACA;MACA;MACA;IACA;IACA;IACAC;MACA;MACA;MACA;QACA;QACA;MACA;MACA;MACA;QACA;QACA;MACA;QACA;QACA;MACA;QACA;QACA;MACA;MACA;MACA;MACA;QACA;MACA;IACA;EACA;EACAC;IACA;IACA;EACA;AACA","names":["data","value","hotKeywordList","historyData","defaultKeyword","openId","show","order","keywords","isActive","newValue","methods","onSearch","addHistory","keyword","getSearchInfo","getInfo","onCancel","onClickLeft","deteleSearch","deleteHistory","getPromptInfo","getPrompt","promptSearch","getNewInfo","goGoods","changeItem","created"],"sourceRoot":"src/views/home/search","sources":["index.vue"],"sourcesContent":["<template>\r\n  <div class=\"container\">\r\n    <!-- 头部导航栏 -->\r\n    <van-nav-bar title=\"乐购\" left-text=\"返回\" left-arrow @click-left=\"onClickLeft\" />\r\n    <form action=\"/\">\r\n      <van-search v-model=\"value\" show-action :placeholder=\"defaultKeyword.keyword\" @search=\"onSearch\" @cancel=\"onCancel\" @input=\"getPromptInfo\" />\r\n    </form>\r\n    <div v-if=\"show === 1\">\r\n      <!-- 历史记录 -->\r\n      <div class=\"history1\" v-if=\"historyData.length !== 0\">\r\n        <div class=\"header\">\r\n          <p>历史记录</p>\r\n          <img src=\"@/assets/images/del-address.png\" alt=\"\" @click=\"deteleSearch\" />\r\n        </div>\r\n        <div class=\"historyItem\">\r\n          <div class=\"historyItem1\" v-for=\"item in historyData\" :key=\"item.id\" @click=\"onSearch(item.keyword)\">{{ item.keyword }}</div>\r\n        </div>\r\n      </div>\r\n      <!-- 热门搜索 -->\r\n      <div class=\"hotSearch\">\r\n        <p>热门搜索</p>\r\n        <div class=\"hotSearchItem\">\r\n          <div class=\"hotSearchItem1\" v-for=\"item in hotKeywordList\" :key=\"item.keyword\" :class=\"item.is_hot === 1 ? 'active' : ''\" @click=\"onSearch(item.keyword)\">{{ item.keyword }}</div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <!-- 输入框开始输入 -->\r\n    <div class=\"input\" v-else-if=\"show === 2\">\r\n      <p v-if=\"keywords.length === 0\" class=\"noGoods\">数据库暂无此类产品...</p>\r\n      <p class=\"item\" v-for=\"item in keywords\" :key=\"item.id\" @click=\"goGoods(item.name)\" v-else>{{ item.name }}</p>\r\n    </div>\r\n\r\n    <!-- 点击产品跳转至产品详情 -->\r\n    <div class=\"goods\" v-else>\r\n      <!-- 三级分类 -->\r\n      <div class=\"category\">\r\n        <div :class=\"{ active: isActive === 1 }\" @click=\"changeItem(1)\">综合</div>\r\n        <div class=\"price\" :class=\"{ active: isActive === 2 }\" @click=\"changeItem(2)\">\r\n          价格\r\n          <div class=\"icons\">\r\n            <van-icon name=\"arrow-up\" :color=\"this.isActive === 2 && arrow === 'up' ? '#b4282d' : ''\" />\r\n            <van-icon name=\"arrow-down\" :color=\"this.isActive === 2 && arrow === 'down' ? '#b4282d' : ''\" />\r\n          </div>\r\n        </div>\r\n        <div :class=\"{ active: isActive === 3 }\" @click=\"changeItem(3)\">分类</div>\r\n      </div>\r\n      <!-- 产品item -->\r\n      <div class=\"content\">\r\n        <div class=\"item\" v-for=\"item in keywords\" :key=\"item.id\">\r\n          <img :src=\"item.list_pic_url\" alt=\"\" />\r\n          <p class=\"name\">{{ item.name }}</p>\r\n          <p class=\"price\">{{ item.retail_price }}</p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { getInfo, deleteHistory, addHistory, promptSearch } from '@/api/home/search/index.js'\r\nexport default {\r\n  data() {\r\n    return {\r\n      value: '', // 输入框的关键词\r\n      hotKeywordList: [], // 热门搜索关键词\r\n      historyData: [], // 历史搜索记录\r\n      defaultKeyword: {}, // 默认的搜索框提示\r\n      openId: '', // 登录id\r\n      show: 1, // 搜索的页面是都展开\r\n      order: '', // 排序参数  asc desc\r\n      keywords: [], // 搜索的联系词\r\n      isActive: '', // 三级分类高亮颜色\r\n      newValue: ''\r\n    }\r\n  },\r\n  methods: {\r\n    // 点击搜索 添加关键词\r\n    onSearch(keyword) {\r\n      // keyword openId\r\n      addHistory({ openId: this.openId, keyword: this.value || keyword }).then(res => {\r\n        this.getSearchInfo()\r\n        this.value = ''\r\n      })\r\n      if (this.value === '') {\r\n        this.show = 1\r\n      }\r\n    },\r\n    // 获取数据\r\n    getSearchInfo() {\r\n      this.openId = localStorage.getItem('openId')\r\n      getInfo({ openId: this.openId }).then(res => {\r\n        this.hotKeywordList = res.hotKeywordList\r\n        this.historyData = res.historyData\r\n        this.defaultKeyword = res.defaultKeyword\r\n      })\r\n    },\r\n    //  点击取消\r\n    onCancel() {\r\n      this.$router.push('/home')\r\n    },\r\n    // 点击返回\r\n    onClickLeft() {\r\n      this.$router.go(-1)\r\n    },\r\n    // 点击删除历史记录\r\n    deteleSearch() {\r\n      deleteHistory({ openId: this.openId }).then(res => {\r\n        this.getSearchInfo()\r\n      })\r\n    },\r\n    // 搜索框发生变化\r\n    getPromptInfo() {\r\n      this.show = 2\r\n      this.getPrompt()\r\n      if (this.value === '') {\r\n        this.show = 1\r\n      }\r\n    },\r\n    // 获取搜索提示\r\n    getPrompt() {\r\n      //  keyword order\r\n      promptSearch({ keyword: this.value, order: this.order }).then(res => {\r\n        this.keywords = res.keywords\r\n      })\r\n    },\r\n    // 关键词更新后的搜索\r\n    getNewInfo() {\r\n      promptSearch({ keyword: this.newValue, order: this.order }).then(res => {\r\n        this.keywords = res.keywords\r\n      })\r\n    },\r\n    // 点击搜索产品跳转至对应产品\r\n    goGoods(keyword) {\r\n      this.show = 3\r\n      this.isActive = 1\r\n      this.newValue = keyword\r\n      this.getNewInfo()\r\n    },\r\n    // 点击添加颜色\r\n    changeItem(i) {\r\n      this.isActive = i\r\n      // 点击综合\r\n      if (this.isActive === 1) {\r\n        this.order = ''\r\n        this.getNewInfo()\r\n      }\r\n      // 点击价格\r\n      if (this.isActive === 2 && this.arrow === '') {\r\n        this.arrow = 'up'\r\n        this.order = 'asc'\r\n      } else if (this.isActive === 2 && this.arrow === 'up') {\r\n        this.arrow = 'down'\r\n        this.order = 'desc'\r\n      } else {\r\n        this.arrow = 'up'\r\n        this.order = 'asc'\r\n      }\r\n      this.getNewInfo()\r\n      // 点击分类 没有变化\r\n      if (this.isActive === 3) {\r\n        this.getNewInfo()\r\n      }\r\n    }\r\n  },\r\n  created() {\r\n    this.show = 1\r\n    this.getSearchInfo()\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.container {\r\n  height: 100%;\r\n  background-color: #eee;\r\n  // height: 100vh;\r\n  .history1 {\r\n    background-color: #fff;\r\n    padding: 16px;\r\n    margin-bottom: 10px;\r\n    .header {\r\n      display: flex;\r\n      justify-content: space-between;\r\n      align-items: center;\r\n      margin: 16px 0;\r\n      img {\r\n        width: 20px;\r\n        height: 20px;\r\n      }\r\n    }\r\n    .historyItem {\r\n      display: inline-block;\r\n      .historyItem1 {\r\n        display: inline-block;\r\n        border: 1px solid;\r\n        padding: 5px;\r\n        margin: 5px 5px 5px 0;\r\n      }\r\n    }\r\n  }\r\n\r\n  .hotSearch {\r\n    background-color: #fff;\r\n    padding: 16px;\r\n    margin-bottom: 10px;\r\n    p {\r\n      margin: 16px 0;\r\n    }\r\n    .hotSearchItem {\r\n      display: inline-block;\r\n      .hotSearchItem1 {\r\n        display: inline-block;\r\n        border: 1px solid;\r\n        padding: 5px;\r\n        margin: 5px 10px 5px 0;\r\n      }\r\n      .active {\r\n        color: #b4282d;\r\n      }\r\n    }\r\n  }\r\n}\r\n.input {\r\n  background-color: #fff;\r\n  .noGoods {\r\n    text-align: center;\r\n    padding: 150px 0;\r\n  }\r\n  .item {\r\n    padding: 10px 0;\r\n    margin-left: 15px;\r\n  }\r\n}\r\n.goods {\r\n  .category {\r\n    display: flex;\r\n    justify-content: space-around;\r\n    width: 100%;\r\n    align-items: center;\r\n    background-color: #fff;\r\n    height: 30px;\r\n    line-height: 30px;\r\n    margin-bottom: 10px;\r\n    padding: 4px 0;\r\n    .active {\r\n      color: #b4282d;\r\n    }\r\n    .icons {\r\n      display: flex;\r\n      align-items: center;\r\n      flex-direction: column;\r\n      margin-left: 10px;\r\n      color: gray;\r\n    }\r\n    .price {\r\n      display: flex;\r\n    }\r\n  }\r\n  .content {\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    justify-content: space-between;\r\n    background-color: #eee;\r\n    .item {\r\n      text-align: center;\r\n      width: 186px;\r\n      height: 239px;\r\n      margin: 0 0 2.5px;\r\n      // padding: 7.5px 0;\r\n      background-color: #fff;\r\n\r\n      img {\r\n        background-color: #fff;\r\n        width: 151px;\r\n        height: 151px;\r\n      }\r\n      .name {\r\n        margin: 7.5px 0 11px;\r\n      }\r\n      .price {\r\n        color: #b4282d;\r\n        font-size: 15px;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}